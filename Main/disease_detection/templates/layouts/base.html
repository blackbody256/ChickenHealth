{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}KukuIntel - AI Chicken Health Detection{% endblock %}</title>
    
    <!-- Custom Favicon -->
    <link rel="icon" type="image/jpeg" href="{% static 'media/betterkukulogo.jpg' %}">
    <link rel="shortcut icon" type="image/jpeg" href="{% static 'media/betterkukulogo.jpg' %}">
    <link rel="apple-touch-icon" href="{% static 'media/betterkukulogo.jpg' %}">
    
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!--Responsive styling-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/responsive.css' %}">
</head>
<body>
    <!-- Header for non-dashboard pages -->
    {% if not request.user.is_authenticated or request.resolver_match.url_name == 'home' or request.resolver_match.url_name == 'about' %}
    <header class="header">
        <div class="header-container">
            <a href="{% url 'users:home' %}" class="logo">
                <img src="{% static 'media/betterkukulogo.jpg' %}" alt="KukuIntel Logo" class="logo-img">
                <h1>KukuIntel</h1>
            </a>
            <nav class="nav-links">
                {% if request.user.is_authenticated %}
                    <a href="{% url 'users:profile_edit' %}">Profile</a>
                    {% if request.user.role == 'FARMER' %}
                        <a href="{% url 'users:dashboard' %}">Dashboard</a>
                    {% elif request.user.role == 'VET' %}
                        <a href="{% url 'users:vet_dashboard' %}">Dashboard</a>
                    {% elif request.user.role == 'ADMIN' %}
                        <a href="{% url 'users:admin_dashboard' %}">Dashboard</a>
                    {% endif %}
                    <form method="post" action="{% url 'users:logout' %}" style="margin: 0;">
                        {% csrf_token %}
                        <button type="submit" class="logout-btn">Logout</button>
                    </form>
                {% else %}
                    <a href="{% url 'users:about' %}">About</a>
                    <a href="{% url 'users:login' %}">Login</a>
                    <a href="{% url 'users:signup' %}">Sign Up</a>
                {% endif %}
            </nav>
            <button class="hamburger-menu" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>
    {% endif %}

    <!-- Main Layout -->
    <div class="{% if request.user.is_authenticated and request.resolver_match.url_name != 'home' and request.resolver_match.url_name != 'about' %}dashboard-layout{% endif %}">
        {% if request.user.is_authenticated and request.resolver_match.url_name != 'home' and request.resolver_match.url_name != 'about' %}
            <aside class="sidebar">
                <div class="logo">
                    <img src="{% static 'media/betterkukulogo.jpg' %}" alt="KukuIntel Logo" class="logo-img">
                    <h1>KukuIntel</h1>
                </div>
                
                <ul class="sidebar-nav">
                    {% if request.user.role == 'FARMER' %}
                        <li><a href="{% url 'users:dashboard' %}"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                        <li><a href="{% url 'diagnosis:upload_predict' %}"><i class="fas fa-camera"></i> Analyze Health</a></li>
                        <li><a href="{% url 'diagnosis:history' %}"><i class="fas fa-history"></i> History</a></li>
                        <li><a href="{% url 'chat:dashboard' %}"><i class="fas fa-comments"></i> Expert Chat</a></li>
                        <li><a href="{% url 'users:profile_edit' %}"><i class="fas fa-user"></i> Profile</a></li>
                    {% elif request.user.role == 'VET' %}
                        <li><a href="{% url 'users:vet_dashboard' %}"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                        <li><a href="{% url 'diagnosis:upload_predict' %}"><i class="fas fa-bug"></i> Assist Diagnosis</a></li>
                        <li><a href="{% url 'vet:dataset_list' %}"><i class="fas fa-database"></i> Datasets</a></li>
                        <li><a href="{% url 'chat:dashboard' %}"><i class="fas fa-comments"></i> Chat</a></li>
                        <li><a href="{% url 'users:profile_edit' %}"><i class="fas fa-user"></i> Profile</a></li>
                    {% elif request.user.role == 'ADMIN' %}
                        <li><a href="{% url 'users:admin_dashboard' %}"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                        <li><a href="{% url 'users:manage_farmers' %}"><i class="fas fa-users"></i> Manage Farmers</a></li>
                        <li><a href="{% url 'administrator:upload_dataset' %}"><i class="fas fa-upload"></i> Upload Dataset</a></li>
                        <li><a href="{% url 'administrator:dataset_list' %}"><i class="fas fa-database"></i> Datasets</a></li>
                        <li><a href="{% url 'chat:dashboard' %}"><i class="fas fa-comments"></i> Chat</a></li>
                        <li><a href="{% url 'users:profile_edit' %}"><i class="fas fa-user"></i> Profile</a></li>
                    {% endif %}
                    
                    <li>
                        <form method="post" action="{% url 'users:logout' %}">
                            {% csrf_token %}
                            <button type="submit"><i class="fas fa-sign-out-alt"></i> Logout</button>
                        </form>
                    </li>
                </ul>
            </aside>
        {% endif %}
        
        <main class="{% if request.user.is_authenticated and request.resolver_match.url_name != 'home' and request.resolver_match.url_name != 'about' %}content-wrapper{% else %}main-content{% endif %}">
            {% block content %}{% endblock %}
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const hamburgerMenu = document.querySelector('.hamburger-menu');
            const navLinks = document.querySelector('.nav-links');
            const sidebar = document.querySelector('.sidebar');

            hamburgerMenu.addEventListener('click', () => {
                navLinks.classList.toggle('active');
                sidebar.classList.toggle('active');
            });

            // Add active class to current page in sidebar
            const currentPath = window.location.pathname;
            const sidebarLinks = document.querySelectorAll('.sidebar-nav a');
            
            sidebarLinks.forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>